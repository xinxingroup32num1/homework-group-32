# *Project3: implement length extension attack for SM3, SHA256, etc.
 
## 实验目的：  

利用长度扩展攻击SM3。  
  
## 算法说明：  

1. 随机选取字符串m（此处为1234），使用SM3加密得到其hash值h。
2. 随机选取字符串m2（此处为5678），作为扩展攻击的字符串备用。
3. 首先计算出m扩展后的与m2拼接的字符串m1，计算出m1的hash值h1，来作为正确答案以备后用。
4. 在m2前面补充数量为M长度的0，之后以h作为初始向量进行加密，即可得到长度扩展攻击的hash值。之后与正确答案对比发现攻击成功。  
  
## 代码思路：

### SM3实现：

&ensp;&ensp;&ensp;&ensp;定义了SM3算法中需要用到的一些常数和函数，如初始值(IV)、常数(T)、左旋转(ROL)、逻辑函数(FF和GG)以及线性函数(P0和P1)，并提供了相关辅助函数，如进制转换、压缩函数以及消息填充和分组。

### 长度扩展攻击实现：

&ensp;&ensp;&ensp;&ensp;首先，通过TC函数对一个初始消息进行填充，并用SM3函数计算哈希值(Vn)。之后将一个新消息附加到原始消息，并再次进行填充和哈希计算，得到新的哈希值(Vn1)。最后，调用LengthAttack函数，并在第一个消息的末尾附加一些零，模拟攻击者控制的消息扩展，并通过SM3算法得到一个新的哈希值(Vn2)。

&ensp;&ensp;&ensp;&ensp;比较Vn1和Vn2可以看到攻击者成功地扩展了原始消息，而不需要知道原始消息的内容。
  
## 测试方法：

将sm3长度扩展攻击.cpp文件放到项目中运行即可。  

## 实验结果展示：

![image](https://github.com/xinxingroup32num1/homework-group-32/assets/138662552/58b40371-934a-451f-a0ec-d494d0fef049)

如上图所示，运行时间约为0.999ms。
